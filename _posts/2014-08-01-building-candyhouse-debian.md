---
layout: post
title:  "Building Debian for Candyhouse Routers"
tags: cisco linksys e4200v2 candyhouse router firmware debian reverse_engineering
redirect_from: "/projects/candyhouse/build/"
---
## Phase 1 - `debootstrap` a USB stick from your PC
Start by unmounting you USB stick and remounting it manually to avoid any automatic `nodev` or `noexec` mount options:
```
rcw@initiative:/$ sudo umount /dev/sdb1
rcw@initiative:/$ sudo mount /dev/sdb1 /mnt
```
Use `debootstrap` to build the initial filesystem:
```
rcw@initiative:/mnt$ sudo debootstrap --verbose --arch armel --foreign unstable . http://ftp.us.debian.org/debian
I: Retrieving Release 
I: Retrieving Release.gpg 
I: Checking Release signature
I: Valid Release signature (key id A1BD8E9D78F7FE5C3E65D8AF8B48AD6246925553)
I: Retrieving Packages 
I: Validating Packages 
I: Resolving dependencies of required packages...
I: Resolving dependencies of base packages...
I: Found additional required dependencies: insserv libbz2-1.0 libcap2 libdb5.1 libsemanage-common libsemanage1 libslang2 libustr-1.0-1 
I: Found additional base dependencies: init-system-helpers libclass-isa-perl libee0 libept1.4.12 libestr0 libgcrypt11 libgnutls-openssl27 libgnutls26 libgpg-error0 libidn11 libjson-c2 liblognorm0 libmnl0 libnetfilter-acct1 libnfnetlink0 libp11-kit0 libsqlite3-0 libswitch-perl libtasn1-3 libxapian22 perl perl-modules 
I: Checking component main on http://ftp.us.debian.org/debian...
I: Retrieving libacl1 2.2.52-1
I: Validating libacl1 2.2.52-1
I: Retrieving adduser 3.113+nmu3
I: Validating adduser 3.113+nmu3
I: Retrieving apt 0.9.9
I: Validating apt 0.9.9
I: Retrieving apt-utils 0.9.9
I: Validating apt-utils 0.9.9
I: Retrieving libapt-inst1.5 0.9.9
I: Validating libapt-inst1.5 0.9.9
I: Retrieving libapt-pkg4.12 0.9.9
I: Validating libapt-pkg4.12 0.9.9
I: Retrieving aptitude 0.6.8.2-1
I: Validating aptitude 0.6.8.2-1
I: Retrieving aptitude-common 0.6.8.2-1
I: Validating aptitude-common 0.6.8.2-1
I: Retrieving libattr1 1%3a2.4.47-1
I: Validating libattr1 1%3a2.4.47-1
I: Retrieving base-files 7.2
I: Validating base-files 7.2
I: Retrieving base-passwd 3.5.26
I: Validating base-passwd 3.5.26
I: Retrieving bash 4.2+dfsg-1
I: Validating bash 4.2+dfsg-1
I: Retrieving libboost-iostreams1.49.0 1.49.0-4
I: Validating libboost-iostreams1.49.0 1.49.0-4
I: Retrieving libboost-iostreams1.53.0 1.53.0-5
I: Validating libboost-iostreams1.53.0 1.53.0-5
I: Retrieving libboost-iostreams1.54.0 1.54.0-1
I: Validating libboost-iostreams1.54.0 1.54.0-1
I: Retrieving bsdmainutils 9.0.5
I: Validating bsdmainutils 9.0.5
I: Retrieving libbz2-1.0 1.0.6-4
I: Validating libbz2-1.0 1.0.6-4
I: Retrieving coreutils 8.13-3.3
I: Validating coreutils 8.13-3.3
I: Retrieving cpio 2.11+dfsg-1
I: Validating cpio 2.11+dfsg-1
I: Retrieving cron 3.0pl1-124
I: Validating cron 3.0pl1-124
I: Retrieving libcwidget3 0.5.16-3.4
I: Validating libcwidget3 0.5.16-3.4
I: Retrieving dash 0.5.7-3
I: Validating dash 0.5.7-3
I: Retrieving libdb5.1 5.1.29-6
I: Validating libdb5.1 5.1.29-6
I: Retrieving debconf 1.5.50
I: Validating debconf 1.5.50
I: Retrieving debconf-i18n 1.5.50
I: Validating debconf-i18n 1.5.50
I: Retrieving debian-archive-keyring 2012.4
I: Validating debian-archive-keyring 2012.4
I: Retrieving debianutils 4.3.4
I: Validating debianutils 4.3.4
I: Retrieving diffutils 1%3a3.2-8
I: Validating diffutils 1%3a3.2-8
I: Retrieving dpkg 1.16.10
I: Validating dpkg 1.16.10
I: Retrieving e2fslibs 1.42.8-1
I: Validating e2fslibs 1.42.8-1
I: Retrieving e2fsprogs 1.42.8-1
I: Validating e2fsprogs 1.42.8-1
I: Retrieving libcomerr2 1.42.8-1
I: Validating libcomerr2 1.42.8-1
I: Retrieving libss2 1.42.8-1
I: Validating libss2 1.42.8-1
I: Retrieving libc-bin 2.17-7
I: Validating libc-bin 2.17-7
I: Retrieving libc6 2.17-7
I: Validating libc6 2.17-7
I: Retrieving multiarch-support 2.17-7
I: Validating multiarch-support 2.17-7
I: Retrieving findutils 4.4.2-6
I: Validating findutils 4.4.2-6
I: Retrieving gcc-4.7-base 4.7.3-5
I: Validating gcc-4.7-base 4.7.3-5
I: Retrieving gcc-4.8-base 4.8.1-5
I: Validating gcc-4.8-base 4.8.1-5
I: Retrieving libgcc1 1%3a4.8.1-5
I: Validating libgcc1 1%3a4.8.1-5
I: Retrieving libstdc++6 4.8.1-5
I: Validating libstdc++6 4.8.1-5
I: Retrieving libgdbm3 1.8.3-12
I: Validating libgdbm3 1.8.3-12
I: Retrieving gnupg 1.4.12-7
I: Validating gnupg 1.4.12-7
I: Retrieving gpgv 1.4.12-7
I: Validating gpgv 1.4.12-7
I: Retrieving libgnutls-openssl27 2.12.23-5
I: Validating libgnutls-openssl27 2.12.23-5
I: Retrieving libgnutls26 2.12.23-5
I: Validating libgnutls26 2.12.23-5
I: Retrieving grep 2.14-2
I: Validating grep 2.14-2
I: Retrieving groff-base 1.22.2-3
I: Validating groff-base 1.22.2-3
I: Retrieving gzip 1.6-1
I: Validating gzip 1.6-1
I: Retrieving hostname 3.13
I: Validating hostname 3.13
I: Retrieving ifupdown 0.7.43
I: Validating ifupdown 0.7.43
I: Retrieving init-system-helpers 1.4
I: Validating init-system-helpers 1.4
I: Retrieving insserv 1.14.0-5
I: Validating insserv 1.14.0-5
I: Retrieving iproute 1%3a3.9.0-5
I: Validating iproute 1%3a3.9.0-5
I: Retrieving iproute2 3.9.0-5
I: Validating iproute2 3.9.0-5
I: Retrieving iptables 1.4.18-1
I: Validating iptables 1.4.18-1
I: Retrieving libxtables10 1.4.18-1
I: Validating libxtables10 1.4.18-1
I: Retrieving iputils-ping 3%3a20121221-1
I: Validating iputils-ping 3%3a20121221-1
I: Retrieving isc-dhcp-client 4.2.4-7
I: Validating isc-dhcp-client 4.2.4-7
I: Retrieving isc-dhcp-common 4.2.4-7
I: Validating isc-dhcp-common 4.2.4-7
I: Retrieving libjson-c2 0.11-2
I: Validating libjson-c2 0.11-2
I: Retrieving kmod 9-3
I: Validating kmod 9-3
I: Retrieving libkmod2 9-3
I: Validating libkmod2 9-3
I: Retrieving libcap2 1%3a2.22-1.2
I: Validating libcap2 1%3a2.22-1.2
I: Retrieving libclass-isa-perl 0.36-5
I: Validating libclass-isa-perl 0.36-5
I: Retrieving libee0 0.4.1-1
I: Validating libee0 0.4.1-1
I: Retrieving libept1.4.12 1.0.9
I: Validating libept1.4.12 1.0.9
I: Retrieving libestr0 0.1.5-2
I: Validating libestr0 0.1.5-2
I: Retrieving libgcrypt11 1.5.2-3
I: Validating libgcrypt11 1.5.2-3
I: Retrieving libgpg-error0 1.10-3.1
I: Validating libgpg-error0 1.10-3.1
I: Retrieving libidn11 1.25-2
I: Validating libidn11 1.25-2
I: Retrieving liblocale-gettext-perl 1.05-7+b1
I: Validating liblocale-gettext-perl 1.05-7+b1
I: Retrieving liblognorm0 0.3.6-2
I: Validating liblognorm0 0.3.6-2
I: Retrieving libmnl0 1.0.3-3
I: Validating libmnl0 1.0.3-3
I: Retrieving libnetfilter-acct1 1.0.1-2
I: Validating libnetfilter-acct1 1.0.1-2
I: Retrieving libnfnetlink0 1.0.1-2
I: Validating libnfnetlink0 1.0.1-2
I: Retrieving libpipeline1 1.2.4-1
I: Validating libpipeline1 1.2.4-1
I: Retrieving libselinux1 2.1.13-2
I: Validating libselinux1 2.1.13-2
I: Retrieving libsemanage-common 2.1.10-2
I: Validating libsemanage-common 2.1.10-2
I: Retrieving libsemanage1 2.1.10-2
I: Validating libsemanage1 2.1.10-2
I: Retrieving libsepol1 2.1.9-2
I: Validating libsepol1 2.1.9-2
I: Retrieving libsigc++-2.0-0c2a 2.2.10-0.2
I: Validating libsigc++-2.0-0c2a 2.2.10-0.2
I: Retrieving libswitch-perl 2.16-2
I: Validating libswitch-perl 2.16-2
I: Retrieving libtasn1-3 2.14-3
I: Validating libtasn1-3 2.14-3
I: Retrieving libtext-charwidth-perl 0.04-7+b1
I: Validating libtext-charwidth-perl 0.04-7+b1
I: Retrieving libtext-iconv-perl 1.7-5
I: Validating libtext-iconv-perl 1.7-5
I: Retrieving libtext-wrapi18n-perl 0.06-7
I: Validating libtext-wrapi18n-perl 0.06-7
I: Retrieving libusb-0.1-4 2%3a0.1.12-23.2
I: Validating libusb-0.1-4 2%3a0.1.12-23.2
I: Retrieving logrotate 3.8.5-1
I: Validating logrotate 3.8.5-1
I: Retrieving lsb-base 4.1+Debian12
I: Validating lsb-base 4.1+Debian12
I: Retrieving man-db 2.6.5-2
I: Validating man-db 2.6.5-2
I: Retrieving manpages 3.51-1
I: Validating manpages 3.51-1
I: Retrieving mawk 1.3.3-17
I: Validating mawk 1.3.3-17
I: Retrieving nano 2.2.6-1+b1
I: Validating nano 2.2.6-1+b1
I: Retrieving libncurses5 5.9+20130608-1
I: Validating libncurses5 5.9+20130608-1
I: Retrieving libncursesw5 5.9+20130608-1
I: Validating libncursesw5 5.9+20130608-1
I: Retrieving libtinfo5 5.9+20130608-1
I: Validating libtinfo5 5.9+20130608-1
I: Retrieving ncurses-base 5.9+20130608-1
I: Validating ncurses-base 5.9+20130608-1
I: Retrieving ncurses-bin 5.9+20130608-1
I: Validating ncurses-bin 5.9+20130608-1
I: Retrieving net-tools 1.60-25
I: Validating net-tools 1.60-25
I: Retrieving netbase 5.1
I: Validating netbase 5.1
I: Retrieving netcat-traditional 1.10-40
I: Validating netcat-traditional 1.10-40
I: Retrieving libnewt0.52 0.52.15-2
I: Validating libnewt0.52 0.52.15-2
I: Retrieving whiptail 0.52.15-2
I: Validating whiptail 0.52.15-2
I: Retrieving nfacct 1.0.0-1
I: Validating nfacct 1.0.0-1
I: Retrieving libssl1.0.0 1.0.1e-3
I: Validating libssl1.0.0 1.0.1e-3
I: Retrieving libp11-kit0 0.18.4-1
I: Validating libp11-kit0 0.18.4-1
I: Retrieving libpam-modules 1.1.3-9
I: Validating libpam-modules 1.1.3-9
I: Retrieving libpam-modules-bin 1.1.3-9
I: Validating libpam-modules-bin 1.1.3-9
I: Retrieving libpam-runtime 1.1.3-9
I: Validating libpam-runtime 1.1.3-9
I: Retrieving libpam0g 1.1.3-9
I: Validating libpam0g 1.1.3-9
I: Retrieving libpcre3 1%3a8.31-2
I: Validating libpcre3 1%3a8.31-2
I: Retrieving perl 5.14.2-21
I: Validating perl 5.14.2-21
I: Retrieving perl-base 5.14.2-21
I: Validating perl-base 5.14.2-21
I: Retrieving perl-modules 5.14.2-21
I: Validating perl-modules 5.14.2-21
I: Retrieving libpopt0 1.16-7
I: Validating libpopt0 1.16-7
I: Retrieving libprocps0 1%3a3.3.4-2
I: Validating libprocps0 1%3a3.3.4-2
I: Retrieving libprocps1 1%3a3.3.8-2
I: Validating libprocps1 1%3a3.3.8-2
I: Retrieving procps 1%3a3.3.8-2
I: Validating procps 1%3a3.3.8-2
I: Retrieving libreadline6 6.2+dfsg-0.1
I: Validating libreadline6 6.2+dfsg-0.1
I: Retrieving readline-common 6.2+dfsg-0.1
I: Validating readline-common 6.2+dfsg-0.1
I: Retrieving rsyslog 7.4.1-3
I: Validating rsyslog 7.4.1-3
I: Retrieving sed 4.2.2-1
I: Validating sed 4.2.2-1
I: Retrieving sensible-utils 0.0.9
I: Validating sensible-utils 0.0.9
I: Retrieving login 1%3a4.1.5.1-1
I: Validating login 1%3a4.1.5.1-1
I: Retrieving passwd 1%3a4.1.5.1-1
I: Validating passwd 1%3a4.1.5.1-1
I: Retrieving libslang2 2.2.4-15
I: Validating libslang2 2.2.4-15
I: Retrieving libsqlite3-0 3.7.17-1
I: Validating libsqlite3-0 3.7.17-1
I: Retrieving initscripts 2.88dsf-41
I: Validating initscripts 2.88dsf-41
I: Retrieving sysv-rc 2.88dsf-41
I: Validating sysv-rc 2.88dsf-41
I: Retrieving sysvinit 2.88dsf-41
I: Validating sysvinit 2.88dsf-41
I: Retrieving sysvinit-utils 2.88dsf-41
I: Validating sysvinit-utils 2.88dsf-41
I: Retrieving tar 1.26+dfsg-6
I: Validating tar 1.26+dfsg-6
I: Retrieving tasksel 3.16
I: Validating tasksel 3.16
I: Retrieving tasksel-data 3.16
I: Validating tasksel-data 3.16
I: Retrieving info 5.1.dfsg.1-3
I: Validating info 5.1.dfsg.1-3
I: Retrieving install-info 5.1.dfsg.1-3
I: Validating install-info 5.1.dfsg.1-3
I: Retrieving traceroute 1%3a2.0.19-3
I: Validating traceroute 1%3a2.0.19-3
I: Retrieving tzdata 2013c-2
I: Validating tzdata 2013c-2
I: Retrieving libudev0 175-7.2
I: Validating libudev0 175-7.2
I: Retrieving udev 175-7.2
I: Validating udev 175-7.2
I: Retrieving libustr-1.0-1 1.0.4-3
I: Validating libustr-1.0-1 1.0.4-3
I: Retrieving bsdutils 1%3a2.20.1-5.4
I: Validating bsdutils 1%3a2.20.1-5.4
I: Retrieving libblkid1 2.20.1-5.4
I: Validating libblkid1 2.20.1-5.4
I: Retrieving libmount1 2.20.1-5.4
I: Validating libmount1 2.20.1-5.4
I: Retrieving libuuid1 2.20.1-5.4
I: Validating libuuid1 2.20.1-5.4
I: Retrieving mount 2.20.1-5.4
I: Validating mount 2.20.1-5.4
I: Retrieving util-linux 2.20.1-5.4
I: Validating util-linux 2.20.1-5.4
I: Retrieving vim-common 2%3a7.3.923-3
I: Validating vim-common 2%3a7.3.923-3
I: Retrieving vim-tiny 2%3a7.3.923-3
I: Validating vim-tiny 2%3a7.3.923-3
I: Retrieving wget 1.14-2
I: Validating wget 1.14-2
I: Retrieving libxapian22 1.2.15-2
I: Validating libxapian22 1.2.15-2
I: Retrieving liblzma5 5.1.1alpha+20120614-2
I: Validating liblzma5 5.1.1alpha+20120614-2
I: Retrieving zlib1g 1%3a1.2.8.dfsg-1
I: Validating zlib1g 1%3a1.2.8.dfsg-1
I: Chosen extractor for .deb packages: dpkg-deb
I: Extracting libacl1...
I: Extracting libattr1...
I: Extracting base-files...
I: Extracting base-passwd...
I: Extracting bash...
I: Extracting libbz2-1.0...
I: Extracting coreutils...
I: Extracting dash...
I: Extracting libdb5.1...
I: Extracting debconf...
I: Extracting debconf-i18n...
I: Extracting debianutils...
I: Extracting diffutils...
I: Extracting dpkg...
I: Extracting e2fslibs...
I: Extracting e2fsprogs...
I: Extracting libcomerr2...
I: Extracting libss2...
I: Extracting libc-bin...
I: Extracting libc6...
I: Extracting multiarch-support...
I: Extracting findutils...
I: Extracting gcc-4.7-base...
I: Extracting gcc-4.8-base...
I: Extracting libgcc1...
I: Extracting grep...
I: Extracting gzip...
I: Extracting hostname...
I: Extracting insserv...
I: Extracting libcap2...
I: Extracting liblocale-gettext-perl...
I: Extracting libselinux1...
I: Extracting libsemanage-common...
I: Extracting libsemanage1...
I: Extracting libsepol1...
I: Extracting libtext-charwidth-perl...
I: Extracting libtext-iconv-perl...
I: Extracting libtext-wrapi18n-perl...
I: Extracting lsb-base...
I: Extracting mawk...
I: Extracting libncurses5...
I: Extracting libtinfo5...
I: Extracting ncurses-base...
I: Extracting ncurses-bin...
I: Extracting libpam-modules...
I: Extracting libpam-modules-bin...
I: Extracting libpam-runtime...
I: Extracting libpam0g...
I: Extracting libpcre3...
I: Extracting perl-base...
I: Extracting sed...
I: Extracting sensible-utils...
I: Extracting login...
I: Extracting passwd...
I: Extracting libslang2...
I: Extracting initscripts...
I: Extracting sysv-rc...
I: Extracting sysvinit...
I: Extracting sysvinit-utils...
I: Extracting tar...
I: Extracting tzdata...
I: Extracting libustr-1.0-1...
I: Extracting bsdutils...
I: Extracting libblkid1...
I: Extracting libmount1...
I: Extracting libuuid1...
I: Extracting mount...
I: Extracting util-linux...
I: Extracting liblzma5...
I: Extracting zlib1g...
rcw@initiative:/mnt$ 
```
`umount` the USB stick.  It could take a while for your system to dump all of the cached writes we just did to the USB stick to allow it to unmount.  Give it time:
```
rcw@initiative:/mnt$ cd 
rcw@initiative:~$ sudo umount /mnt
rcw@initiative:~$ 
```
## Phase 2 - Finish `debootstrap` on the E4200v2
Plug the USB stick into your E4200v2, then `mount` it:
```
~ # mount /dev/sda1 /mnt
```
`chroot` to wherever you mounted the USB stick:
```
~ # chroot /mnt /bin/bash
```
Run `dbootstrap`'s second stage:
```
I have no name!@Cisco39597:/# export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/lib/arm-linux-gnueab 
I have no name!@Cisco39597:/# /debootstrap/debootstrap --second-stage --verbose
I: Installing core packages...
I: Unpacking required packages...
I: Unpacking libacl1:armel...
I: Unpacking libattr1:armel...
I: Unpacking base-files...
I: Unpacking base-passwd...
I: Unpacking bash...
I: Unpacking libbz2-1.0:armel...
I: Unpacking coreutils...
I: Unpacking dash...
I: Unpacking libdb5.1:armel...
I: Unpacking debconf...
I: Unpacking debconf-i18n...
I: Unpacking debianutils...
I: Unpacking diffutils...
I: Unpacking dpkg...
I: Unpacking e2fslibs:armel...
I: Unpacking e2fsprogs...
I: Unpacking libcomerr2:armel...
I: Unpacking libss2:armel...
I: Unpacking libc-bin...
I: Unpacking libc6:armel...
I: Unpacking multiarch-support...
I: Unpacking findutils...
I: Unpacking gcc-4.7-base:armel...
I: Unpacking gcc-4.8-base:armel...
I: Unpacking libgcc1:armel...
I: Unpacking grep...
I: Unpacking gzip...
I: Unpacking hostname...
I: Unpacking insserv...
I: Unpacking libcap2:armel...
I: Unpacking liblocale-gettext-perl...
I: Unpacking libselinux1:armel...
I: Unpacking libsemanage-common...
I: Unpacking libsemanage1:armel...
I: Unpacking libsepol1:armel...
I: Unpacking libtext-charwidth-perl...
I: Unpacking libtext-iconv-perl...
I: Unpacking libtext-wrapi18n-perl...
I: Unpacking lsb-base...
I: Unpacking mawk...
I: Unpacking libncurses5:armel...
I: Unpacking libtinfo5:armel...
I: Unpacking ncurses-base...
I: Unpacking ncurses-bin...
I: Unpacking libpam-modules:armel...
I: Unpacking libpam-modules-bin...
I: Unpacking libpam-runtime...
I: Unpacking libpam0g:armel...
I: Unpacking libpcre3:armel...
I: Unpacking perl-base...
I: Unpacking sed...
I: Unpacking sensible-utils...
I: Unpacking login...
I: Unpacking passwd...
I: Unpacking libslang2:armel...
I: Unpacking initscripts...
I: Unpacking sysv-rc...
I: Unpacking sysvinit...
I: Unpacking sysvinit-utils...
I: Unpacking tar...
I: Unpacking tzdata...
I: Unpacking libustr-1.0-1:armel...
I: Unpacking bsdutils...
I: Unpacking libblkid1:armel...
I: Unpacking libmount1...
I: Unpacking libuuid1:armel...
I: Unpacking mount...
I: Unpacking util-linux...
I: Unpacking liblzma5:armel...
I: Unpacking zlib1g:armel...
I: Configuring required packages...
I: Configuring lsb-base...
I: Configuring ncurses-base...
I: Configuring sensible-utils...
I: Configuring gcc-4.8-base:armel...
I: Configuring libsemanage-common...
I: Configuring gcc-4.7-base:armel...
I: Configuring libc6:armel...
I: Configuring debianutils...
I: Configuring base-passwd...
I: Configuring mawk...
I: Configuring hostname...
I: Configuring findutils...
I: Configuring insserv...
I: Configuring multiarch-support...
I: Configuring libsepol1:armel...
I: Configuring libgcc1:armel...
I: Configuring base-files...
I: Configuring libattr1:armel...
I: Configuring e2fslibs:armel...
I: Configuring libcomerr2:armel...
I: Configuring libacl1:armel...
I: Configuring libslang2:armel...
I: Configuring libss2:armel...
I: Configuring liblzma5:armel...
I: Configuring libdb5.1:armel...
I: Configuring libpcre3:armel...
I: Configuring libbz2-1.0:armel...
I: Configuring libtinfo5:armel...
I: Configuring libselinux1:armel...
I: Configuring libcap2:armel...
I: Configuring libustr-1.0-1:armel...
I: Configuring bsdutils...
I: Configuring ncurses-bin...
I: Configuring libsemanage1:armel...
I: Configuring tar...
I: Configuring zlib1g:armel...
I: Configuring libncurses5:armel...
I: Configuring dpkg...
I: Configuring libc-bin...
I: Configuring sysvinit-utils...
I: Configuring dash...
I: Configuring coreutils...
I: Configuring perl-base...
I: Configuring diffutils...
I: Configuring libtext-iconv-perl...
I: Configuring sed...
I: Configuring grep...
I: Configuring gzip...
I: Configuring liblocale-gettext-perl...
I: Configuring bash...
I: Configuring libtext-charwidth-perl...
I: Configuring libtext-wrapi18n-perl...
I: Configuring debconf...
I: Configuring libpam0g:armel...
I: Configuring sysv-rc...
I: Configuring tzdata...
I: Configuring debconf-i18n...
I: Configuring initscripts...
I: Configuring libpam-modules-bin...
I: Configuring libpam-modules:armel...
I: Configuring passwd...
I: Configuring libpam-runtime...
I: Configuring sysvinit...
I: Configuring login...
I: Configuring libuuid1:armel...
I: Configuring libblkid1:armel...
I: Configuring util-linux...
I: Configuring libmount1...
I: Configuring mount...
I: Configuring e2fsprogs...
I: Configuring libc-bin...
I: Unpacking the base system...
I: Unpacking adduser...
I: Unpacking apt...
I: Unpacking apt-utils...
I: Unpacking libapt-inst1.5:armel...
I: Unpacking libapt-pkg4.12:armel...
I: Unpacking aptitude...
I: Unpacking aptitude-common...
I: Unpacking libboost-iostreams1.49.0...
I: Unpacking libboost-iostreams1.53.0...
I: Unpacking bsdmainutils...
I: Unpacking cpio...
I: Unpacking cron...
I: Unpacking libcwidget3...
I: Unpacking debian-archive-keyring...
I: Unpacking libstdc++6:armel...
I: Unpacking libgdbm3:armel...
I: Unpacking gnupg...
I: Unpacking gpgv...
I: Unpacking libgnutls-openssl27:armel...
I: Unpacking libgnutls26:armel...
I: Unpacking groff-base...
I: Unpacking ifupdown...
I: Unpacking init-system-helpers...
I: Unpacking iproute...
I: Unpacking iproute2...
I: Unpacking iptables...
I: Unpacking libxtables10...
I: Unpacking iputils-ping...
I: Unpacking isc-dhcp-client...
I: Unpacking isc-dhcp-common...
I: Unpacking libjson-c2:armel...
I: Unpacking kmod...
I: Unpacking libkmod2:armel...
I: Unpacking libclass-isa-perl...
I: Unpacking libee0...
I: Unpacking libept1.4.12...
I: Unpacking libestr0...
I: Unpacking libgcrypt11:armel...
I: Unpacking libgpg-error0:armel...
I: Unpacking libidn11:armel...
I: Unpacking liblognorm0...
I: Unpacking libmnl0:armel...
I: Unpacking libnetfilter-acct1:armel...
I: Unpacking libnfnetlink0:armel...
I: Unpacking libpipeline1:armel...
I: Unpacking libsigc++-2.0-0c2a:armel...
I: Unpacking libswitch-perl...
I: Unpacking libtasn1-3:armel...
I: Unpacking libusb-0.1-4:armel...
I: Unpacking logrotate...
I: Unpacking man-db...
I: Unpacking manpages...
I: Unpacking nano...
I: Unpacking libncursesw5:armel...
I: Unpacking net-tools...
I: Unpacking netbase...
I: Unpacking netcat-traditional...
I: Unpacking libnewt0.52:armel...
I: Unpacking whiptail...
I: Unpacking nfacct...
I: Unpacking libssl1.0.0:armel...
I: Unpacking libp11-kit0:armel...
I: Unpacking perl...
I: Unpacking perl-modules...
I: Unpacking libpopt0:armel...
I: Unpacking libprocps0:armel...
I: Unpacking libprocps1:armel...
I: Unpacking procps...
I: Unpacking libreadline6:armel...
I: Unpacking readline-common...
I: Unpacking rsyslog...
I: Unpacking libsqlite3-0:armel...
I: Unpacking tasksel...
I: Unpacking tasksel-data...
I: Unpacking info...
I: Unpacking install-info...
I: Unpacking traceroute...
I: Unpacking libudev0:armel...
I: Unpacking udev...
I: Unpacking vim-common...
I: Unpacking vim-tiny...
I: Unpacking wget...
I: Unpacking libxapian22...
I: Configuring the base system...
I: Configuring iproute2...
I: Configuring gpgv...
I: Configuring libssl1.0.0:armel...
I: Configuring libgdbm3:armel...
I: Configuring isc-dhcp-common...
I: Configuring libtasn1-3:armel...
I: Configuring libpopt0:armel...
I: Configuring libusb-0.1-4:armel...
I: Configuring libgpg-error0:armel...
I: Configuring install-info...
I: Configuring vim-common...
I: Configuring libprocps1:armel...
I: Configuring libprocps0:armel...
I: Configuring libjson-c2:armel...
I: Configuring libestr0...
I: Configuring netbase...
I: Configuring libudev0:armel...
I: Configuring libkmod2:armel...
I: Configuring libclass-isa-perl...
I: Configuring adduser...
I: Configuring traceroute...
I: Configuring manpages...
I: Configuring libsqlite3-0:armel...
I: Configuring iproute...
I: Configuring libidn11:armel...
I: Configuring libnewt0.52:armel...
I: Configuring net-tools...
I: Configuring libxtables10...
I: Configuring libpipeline1:armel...
I: Configuring bsdmainutils...
I: Configuring libee0...
I: Configuring netcat-traditional...
I: Configuring debian-archive-keyring...
I: Configuring libncursesw5:armel...
I: Configuring info...
I: Configuring aptitude-common...
I: Configuring cron...
I: Configuring nano...
I: Configuring libp11-kit0:armel...
I: Configuring libmnl0:armel...
I: Configuring cpio...
I: Configuring libstdc++6:armel...
I: Configuring isc-dhcp-client...
I: Configuring vim-tiny...
I: Configuring readline-common...
I: Configuring libnfnetlink0:armel...
I: Configuring libgcrypt11:armel...
I: Configuring procps...
I: Configuring liblognorm0...
I: Configuring libxapian22...
I: Configuring libboost-iostreams1.53.0...
I: Configuring whiptail...
I: Configuring ifupdown...
I: Configuring kmod...
I: Configuring libapt-pkg4.12:armel...
I: Configuring libept1.4.12...
I: Configuring libapt-inst1.5:armel...
I: Configuring libnetfilter-acct1:armel...
I: Configuring libreadline6:armel...
I: Configuring logrotate...
I: Configuring libboost-iostreams1.49.0...
I: Configuring groff-base...
I: Configuring gnupg...
I: Configuring libsigc++-2.0-0c2a:armel...
I: Configuring libgnutls26:armel...
I: Configuring nfacct...
I: Configuring apt-utils...
I: Configuring udev...
I: Configuring iptables...
I: Configuring man-db...
I: Configuring apt...
I: Configuring libgnutls-openssl27:armel...
I: Configuring wget...
I: Configuring libcwidget3...
I: Configuring aptitude...
I: Configuring iputils-ping...
I: Configuring tasksel...
I: Configuring tasksel-data...
I: Configuring libswitch-perl...
I: Configuring perl-mules...
I: Configuring perl...
I: Configuring init-system-helpers...
I: Configuring rsyslog...
I: Configuring libc-bin...
I: Base system installed successfully.
I have no name!@Cisco39597:/# exit
exit
~ # chroot /mnt /bin/bash
root@Cisco39597:/#
```
The E4200v2 only has 128M of RAM.  We're going to want a swap file:
```
root@Cisco39597:/# dd if=/dev/zero of=/swapfile bs=1024 count=262144   
262144+0 records in
262144+0 records out
268435456 bytes (268 MB) copied, 44.1591 s, 6.1 MB/s
root@Cisco39597:/# mkswap /swapfile 
Setting up swapspace version 1, size = 262140 KiB
no label, UUID=908e8f21-6aab-44c5-b24f-9eddfecf7add
root@Cisco39597:/# echo "/swapfile none swap sw 0 0" >> /etc/fstab
root@Cisco39597:/# swapon -a
root@Cisco39597:/# 
```
Add `/proc` and `/sys` to your `/etc/fstab`:
```
root@Cisco39597:/# cat >> /etc/fstab <<"EOF" 
proc /proc proc defaults 0 0
sysfs /sys sysfs defaults 0 0
EOF
root@Cisco39597:/#
```
Make yourself a sources.list:
```
root@Cisco39597:/# echo "deb http://ftp.us.debian.org/debian unstable main" > /etc/apt/sources.list
```
Update and upgrade:
```
root@Cisco39597:/# aptitude update
Get: 1 http://ftp.us.debian.org unstable InRelease [205 kB]
Get: 2 http://ftp.us.debian.org unstable/main armel Packages [6229 kB]
Get: 3 http://ftp.us.debian.org unstable/main Translation-en [4248 kB]
Fetched 10.7 MB in 42s (249 kB/s)                                               

Current status: 37794 new [+37794].
root@Cisco39597:/# aptitude upgrade
No packages will be installed, upgraded, or removed.
0 packages upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
Need to get 0 B of archives. After unpacking 0 B will be used.

root@Cisco39597:/#
```
Edit inittab to add a serial getty
```
T0:23:respawn:/sbin/getty -L ttyS0 115200
```
Set a root password
```
root@Cisco00112:/# passwd
Enter new UNIX password: 
Retype new UNIX password: 
passwd: password updated successfully
root@Cisco00112:/#
```
Set the hostname:
```
root@Cisco00112:/# echo "candyhouse" > /etc/hostname
```
Setup eth0 (the switch) to request an address from DHCP:
```
root@candyhouse:/# cat >> /etc/network/interfaces.d/eth0 <<"EOF"                        
auto eth0
iface eth0 inet dhcp
EOF  
```
### References
* [ArmEabiHowto (Debian Wiki)](http://wiki.debian.org/ArmEabiHowto)
* [`pivot_root(8)`](http://linux.die.net/man/8/pivot_root)
* [Swap (Debian Wiki)](http://wiki.debian.org/Swap)
